version: '3.8'

services:
  nostube:
    build:
      context: .
      dockerfile: Dockerfile
    image: nostube:latest
    container_name: nostube
    ports:
      - '8080:80'
    environment:
      # Default Nostr relays (comma-separated)
      - RUNTIME_RELAYS=wss://relay.divine.video,wss://relay.damus.io,wss://nos.lol,wss://relay.snort.social

      # Default Blossom servers (comma-separated)
      - RUNTIME_BLOSSOM_SERVERS=https://almond.slidestr.net,https://cdn.satellite.earth

      # Application title
      - RUNTIME_APP_TITLE=nostube

      # Enable debug mode (true/false)
      - RUNTIME_DEBUG=false

      # Custom configuration as JSON (optional)
      # - RUNTIME_CUSTOM_CONFIG={"feature_flags":{"experimental":false}}

    restart: unless-stopped

    healthcheck:
      test: ['CMD', 'wget', '--no-verbose', '--tries=1', '--spider', 'http://localhost/health']
      interval: 30s
      timeout: 3s
      start_period: 5s
      retries: 3

    # Optional: Add logging configuration
    logging:
      driver: 'json-file'
      options:
        max-size: '10m'
        max-file: '3'
